---
title: VirtualGrasp Onboarding Task9 - Plier Manipulation Animation
#tags: [getting_started] 
keywords: casestudy, task9, vgonboarding, disassemble, VG_AnimationDriver, VG_FingerAnimator, VG_ObjectAnimator
#last_updated: July 16, 2016
#summary: "Version 6.0 of the Documentation theme for Jekyll, released July 4, 2016, implements relative links so you can view the files offline or on any server without configuring urls and baseurls. Additionally, you can store pages in subdirectories. Templates for alerts and images are available."
sidebar: main_sidebar_1_4_0
permalink: unity_vgonboarding_task9.1.4.0.html
folder: mydoc
---

{% include onboarding_task.html %}

### Task Description

{% include youtube.html id="7QCeKYOZMVc" %}

#### Interaction behaviors wanted

* We want to be able to use {% include tooltip.html tooltip="PrimaryGrasp" text="primary grasps" %} as a basis to grasp and manipulate an articulated object, the pliers.
* We want to use the controller's GRIP button to control grasp, and once the plier is grasped, to use TRIGGER button to animate closing and opening of the pliers.

### Solution

In VirtualGrasp SDK, we packed the solution of this task in **VirtualGrasp/Scenes/onboarding**, as "Task 9". 
```js
VirtualGrasp/Scenes/onboarding/VG_Onboarding.unity
````

Since grasps generated by VG are static hand poses on individual solid objects, in order to create in-hand manipulation on articulated objects like the pliers shown in this example, a few steps need to be done that will be explained here:

#### Create composite object model of articulated object for primary grasps
{% include image.html file="unity/unity_onboarding_task9_pliers_combined_mesh.png" alt="Composite plier model." caption="Composite plier model for animating in-hand manipulating articulated object." %}

First we need a composite object model (see image above) that contains two separate meshes for each articulated part and a combined mesh that models the two parts together in their initial articulated pose. 

The combined mesh should be marked as an {% include tooltip.html tooltip="VGInteractable" text="interactable" %} object by adding [VG_Articulation](unity_component_vgarticulation.1.4.0.html) to its transform. Then bake the object using [VG_BakingClient](unity_component_vgbakingclient.1.4.0.html). 
Once the object is baked, [VG_GraspEditor](unity_component_vggraspeditor.1.4.0.html) is used to add primary grasps on both left and right hands. 

#### Create finger animation post grasp

Once primary grasps are added for both hands, finger animation can be created with primary grasp finger poses as the starting point.
For each hand side, a [VG_FingerAnimator](unity_component_vgfingeranimator.1.4.0.html) and a [VG_AnimationDriver](unity_component_vganimationdriver.1.4.0.html) component is added to the object. See the images below showing the setup for the left hand: 
   
* The VG_FingerAnimator specifies the proximal and middle bones of the four non-thumb finger(s) are to be animated, and the target local **Rotation** is 18 degrees around Z-axis of bone transform relative to the initial finger pose.  
* And the VG_AnimationDriver specifies the **Action Reference** to use the input signal from controller's TRIGGER button value, which has [0, 1] as **Input Range** to drive the animation. On listening to the **On Driven** event, _VG_FingerAnimator.DriveAnimation(float)_ function receives the input value. The value drives the finger animation by rotating them from the initial pose to the 18 degree target rotation. 
* We set the VG_FingerAnimator to be enabled or disabled in sync with the VG_AnimationDriver by listening to **On Enabled** and **On Disabled** events. This is to prevent fingers to be animated while not grasping any object, since VG_AnimationDriver is only enabled when the **Interactable Object** is grasped by the hand. By doing this, the initial pose would be the primary grasp finger poses.

{% include image.html file="unity/unity_vg_fingeranimator.png" alt="VG Finger Animator." caption="VG Finger Animator." %}

{% include image.html file="unity/unity_vg_animationdriver.png" alt="VG Animation Driver." caption="VG Animation Driver" %}


#### Create object animation in sync with fingers
The previous step of animating fingers allows the non-thumb fingers to close to simulate the squeezing motion on the articulated plier part. Now the plier part, SM_Piler2, that is in contact with these non-thumb fingers should be animated in sync with the finger animation. To do that [VG_ObjectAnimator](unity_component_vgobjectanimator.1.4.0.html) is used:
* VG_ObjectAnimator component is added to the combined mesh transform to keep a clean setup since all components are concentrated in the same transform. **Object** field specifies SM_Piler2 is to be animated. The target rotation is -16 degree around Y-axis of the transform relative to its initial pose as reference pose.
* To drive the animation, similar to VG_FingerAnimator, _VG_ObjectAnimator.Rotate(float)_ function is added to listen to VG_AnimationDriver's **On Driven** event. The same input value in range [0, 1] for finger animation is used to simultaneously drive SM_Plier2 transform to rotate from its initial pose to the -16 degree rotation. 


{% include image.html file="unity/unity_vg_objectanimator.png" alt="VG Object Animator." caption="VG Object Animator" %}

